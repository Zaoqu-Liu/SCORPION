[{"path":"https://zaoqu-liu.github.io/SCORPION/articles/advanced-usage.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Advanced Usage and Best Practices","text":"vignette covers advanced usage patterns, parameter tuning, best practices using SCORPION effectively.","code":"library(SCORPION) library(Matrix) data(scorpionTest)"},{"path":[]},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/advanced-usage.html","id":"gamma-value-metacell-aggregation","dir":"Articles","previous_headings":"Parameter Tuning","what":"Gamma Value (Metacell Aggregation)","title":"Advanced Usage and Best Practices","text":"gammaValue parameter controls many cells aggregated metacell: Guidelines: - γ = 5-10: small datasets (< 1000 cells) - γ = 10-20: medium datasets (1000-10000 cells) - γ = 20-50: large datasets (> 10000 cells)","code":"# Test different gamma values gammas <- c(5, 10, 20) results_gamma <- list()  for(g in gammas) {   set.seed(123)   results_gamma[[as.character(g)]] <- scorpion(     tfMotifs = scorpionTest$tf,     gexMatrix = scorpionTest$gex,     ppiNet = scorpionTest$ppi,     gammaValue = g,     alphaValue = 0.5,     hammingValue = 0.01,     showProgress = FALSE   ) }  # Compare network statistics cat(\"Effect of gamma on network properties:\\n\") #> Effect of gamma on network properties: for(g in gammas) {   r <- results_gamma[[as.character(g)]]   cat(sprintf(\"gamma=%d: mean=%.3f, sd=%.3f\\n\",                g, mean(r$regNet), sd(r$regNet))) } #> gamma=5: mean=-0.004, sd=0.981 #> gamma=10: mean=-0.004, sd=0.977 #> gamma=20: mean=-0.006, sd=0.996"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/advanced-usage.html","id":"alpha-value-learning-rate","dir":"Articles","previous_headings":"Parameter Tuning","what":"Alpha Value (Learning Rate)","title":"Advanced Usage and Best Practices","text":"alphaValue controls quickly networks updated: Guidelines: - α = 0.05-0.1: Conservative, slower convergence stable - α = 0.1-0.2: Default, good balance - α > 0.2: Aggressive, may unstable","code":"# Test different alpha values alphas <- c(0.05, 0.1, 0.2) results_alpha <- list()  for(a in alphas) {   set.seed(123)   results_alpha[[as.character(a)]] <- scorpion(     tfMotifs = scorpionTest$tf,     gexMatrix = scorpionTest$gex,     ppiNet = scorpionTest$ppi,     gammaValue = 10,     alphaValue = a,     hammingValue = 0.001,     showProgress = FALSE   ) }  # Compare convergence behavior cat(\"Effect of alpha on convergence:\\n\") #> Effect of alpha on convergence: for(a in alphas) {   r <- results_alpha[[as.character(a)]]   cat(sprintf(\"alpha=%.2f: edges=%d\\n\", a, r$numEdges)) } #> alpha=0.05: edges=167562 #> alpha=0.10: edges=167562 #> alpha=0.20: edges=167562"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/advanced-usage.html","id":"hamming-threshold","dir":"Articles","previous_headings":"Parameter Tuning","what":"Hamming Threshold","title":"Advanced Usage and Best Practices","text":"hammingValue determines convergence sensitivity:","code":"# Test different hamming thresholds hammings <- c(0.01, 0.001, 0.0001)  set.seed(123) result_h1 <- scorpion(   tfMotifs = scorpionTest$tf,   gexMatrix = scorpionTest$gex,   ppiNet = scorpionTest$ppi,   gammaValue = 10,   alphaValue = 0.1,   hammingValue = 0.01,   showProgress = FALSE )  set.seed(123) result_h2 <- scorpion(   tfMotifs = scorpionTest$tf,   gexMatrix = scorpionTest$gex,   ppiNet = scorpionTest$ppi,   gammaValue = 10,   alphaValue = 0.1,   hammingValue = 0.001,   showProgress = FALSE )  # Compare results cor_reg <- cor(as.vector(result_h1$regNet), as.vector(result_h2$regNet)) cat(\"Correlation between hamming=0.01 and 0.001:\", round(cor_reg, 4), \"\\n\") #> Correlation between hamming=0.01 and 0.001: 1"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/advanced-usage.html","id":"association-methods","dir":"Articles","previous_headings":"","what":"Association Methods","title":"Advanced Usage and Best Practices","text":"SCORPION supports three methods computing gene co-expression:","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/advanced-usage.html","id":"pearson-correlation-default","dir":"Articles","previous_headings":"Association Methods","what":"Pearson Correlation (Default)","title":"Advanced Usage and Best Practices","text":"","code":"set.seed(123) result_pearson <- scorpion(   tfMotifs = scorpionTest$tf,   gexMatrix = scorpionTest$gex,   ppiNet = scorpionTest$ppi,   assocMethod = \"pearson\",   showProgress = FALSE )"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/advanced-usage.html","id":"spearman-correlation","dir":"Articles","previous_headings":"Association Methods","what":"Spearman Correlation","title":"Advanced Usage and Best Practices","text":"Better non-linear relationships:","code":"set.seed(123) result_spearman <- scorpion(   tfMotifs = scorpionTest$tf,   gexMatrix = scorpionTest$gex,   ppiNet = scorpionTest$ppi,   assocMethod = \"spearman\",   showProgress = FALSE )"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/advanced-usage.html","id":"principal-component-regression-pcnet","dir":"Articles","previous_headings":"Association Methods","what":"Principal Component Regression (pcNet)","title":"Advanced Usage and Best Practices","text":"Uses PC regression co-expression estimation:","code":"set.seed(123) result_pcnet <- scorpion(   tfMotifs = scorpionTest$tf,   gexMatrix = scorpionTest$gex,   ppiNet = scorpionTest$ppi,   assocMethod = \"pcNet\",   showProgress = FALSE )"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/advanced-usage.html","id":"comparison","dir":"Articles","previous_headings":"Association Methods","what":"Comparison","title":"Advanced Usage and Best Practices","text":"Comparison association methods","code":"par(mfrow = c(1, 3), mar = c(4, 4, 3, 1))  hist(as.vector(result_pearson$regNet), breaks = 50,       main = \"Pearson\", xlab = \"Edge Weight\", col = \"steelblue\")  hist(as.vector(result_spearman$regNet), breaks = 50,      main = \"Spearman\", xlab = \"Edge Weight\", col = \"coral\")  hist(as.vector(result_pcnet$regNet), breaks = 50,      main = \"pcNet\", xlab = \"Edge Weight\", col = \"forestgreen\")"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/advanced-usage.html","id":"working-with-seurat-objects","dir":"Articles","previous_headings":"","what":"Working with Seurat Objects","title":"Advanced Usage and Best Practices","text":"Seurat object, extract expression matrix:","code":"# Example with Seurat object library(Seurat)  # Extract expression matrix from Seurat v4 gex_matrix <- GetAssayData(seurat_obj, slot = \"counts\")  # Or from Seurat v5 gex_matrix <- seurat_obj[[\"RNA\"]]$counts  # Run SCORPION result <- scorpion(   tfMotifs = tf_data,   gexMatrix = gex_matrix,   ppiNet = ppi_data )"},{"path":[]},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/advanced-usage.html","id":"filter-low-expression-genes","dir":"Articles","previous_headings":"Filtering and Preprocessing","what":"Filter Low-Expression Genes","title":"Advanced Usage and Best Practices","text":"","code":"# Filter genes before running SCORPION set.seed(123) result_filtered <- scorpion(   tfMotifs = scorpionTest$tf,   gexMatrix = scorpionTest$gex,   ppiNet = scorpionTest$ppi,   filterExpr = TRUE,  # Remove zero-expression genes   showProgress = FALSE )  cat(\"Genes after filtering:\", result_filtered$numGenes, \"\\n\") #> Genes after filtering: 214"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/advanced-usage.html","id":"custom-gene-filtering","dir":"Articles","previous_headings":"Filtering and Preprocessing","what":"Custom Gene Filtering","title":"Advanced Usage and Best Practices","text":"","code":"# Manual filtering gex <- scorpionTest$gex  # Keep genes expressed in at least 5% of cells min_cells <- ncol(gex) * 0.05 gex_filtered <- gex[Matrix::rowSums(gex > 0) >= min_cells, ]  cat(\"Original genes:\", nrow(scorpionTest$gex), \"\\n\") #> Original genes: 230 cat(\"Filtered genes:\", nrow(gex_filtered), \"\\n\") #> Filtered genes: 225  # Run with filtered data set.seed(123) result_custom <- scorpion(   tfMotifs = scorpionTest$tf,   gexMatrix = gex_filtered,   ppiNet = scorpionTest$ppi,   showProgress = FALSE )"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/advanced-usage.html","id":"parallel-processing","dir":"Articles","previous_headings":"","what":"Parallel Processing","title":"Advanced Usage and Best Practices","text":"SCORPION supports parallel computation pcNet method:","code":"# Use multiple cores result_parallel <- scorpion(   tfMotifs = tf_data,   gexMatrix = gex_data,   ppiNet = ppi_data,   assocMethod = \"pcNet\",   nCores = 4  # Use 4 cores )"},{"path":[]},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/advanced-usage.html","id":"network-comparison","dir":"Articles","previous_headings":"Output Analysis","what":"Network Comparison","title":"Advanced Usage and Best Practices","text":"Compare networks across conditions: Network comparison across conditions","code":"# Simulate two conditions set.seed(123) result1 <- scorpion(   tfMotifs = scorpionTest$tf,   gexMatrix = scorpionTest$gex,   ppiNet = scorpionTest$ppi,   alphaValue = 0.1,   showProgress = FALSE )  set.seed(456) result2 <- scorpion(   tfMotifs = scorpionTest$tf,   gexMatrix = scorpionTest$gex,   ppiNet = scorpionTest$ppi,   alphaValue = 0.1,   showProgress = FALSE )  # Compare regulatory networks plot(as.vector(result1$regNet), as.vector(result2$regNet),      pch = \".\", col = adjustcolor(\"steelblue\", 0.3),      xlab = \"Condition 1\", ylab = \"Condition 2\",      main = \"Regulatory Network Comparison\") abline(0, 1, col = \"red\", lty = 2)  # Correlation r <- cor(as.vector(result1$regNet), as.vector(result2$regNet)) legend(\"bottomright\", paste(\"r =\", round(r, 3)), bty = \"n\")"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/advanced-usage.html","id":"differential-network-analysis","dir":"Articles","previous_headings":"Output Analysis","what":"Differential Network Analysis","title":"Advanced Usage and Best Practices","text":"","code":"# Compute differential edges diff_net <- result1$regNet - result2$regNet  # Find significantly different edges threshold <- 2 * sd(diff_net) diff_edges <- which(abs(diff_net) > threshold, arr.ind = TRUE)  if(nrow(diff_edges) > 0) {   diff_df <- data.frame(     TF = rownames(diff_net)[diff_edges[,1]],     Gene = colnames(diff_net)[diff_edges[,2]],     Difference = diff_net[diff_edges]   )   diff_df <- diff_df[order(-abs(diff_df$Difference)), ]   cat(\"Top differential edges:\\n\")   head(diff_df, 10) }"},{"path":[]},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/advanced-usage.html","id":"data-quality","dir":"Articles","previous_headings":"Best Practices","what":"1. Data Quality","title":"Advanced Usage and Best Practices","text":"Remove low-quality cells running SCORPION Filter genes low expression Consider batch effects analyzing multiple samples","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/advanced-usage.html","id":"prior-network-selection","dir":"Articles","previous_headings":"Best Practices","what":"2. Prior Network Selection","title":"Advanced Usage and Best Practices","text":"Use species-appropriate TF-target databases Higher-confidence PPI scores improve results Consider tissue-specific priors available","code":""},{"path":[]},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/advanced-usage.html","id":"reproducibility","dir":"Articles","previous_headings":"Best Practices","what":"4. Reproducibility","title":"Advanced Usage and Best Practices","text":"Always set random seed Document parameter choices Save intermediate results large analyses","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/advanced-usage.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session Information","title":"Advanced Usage and Best Practices","text":"","code":"sessionInfo() #> R version 4.4.0 (2024-04-24) #> Platform: aarch64-apple-darwin20 #> Running under: macOS 15.6.1 #>  #> Matrix products: default #> BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0 #>  #> locale: #> [1] C #>  #> time zone: Asia/Shanghai #> tzcode source: internal #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] Matrix_1.7-4   SCORPION_1.2.1 #>  #> loaded via a namespace (and not attached): #>  [1] cli_3.6.5         knitr_1.51        rlang_1.1.7       xfun_0.56         #>  [5] otel_0.2.0        textshaping_1.0.4 jsonlite_2.0.0    htmltools_0.5.9   #>  [9] ragg_1.5.0        sass_0.4.10       rmarkdown_2.30    grid_4.4.0        #> [13] evaluate_1.0.5    jquerylib_0.1.4   fastmap_1.2.0     yaml_2.3.12       #> [17] lifecycle_1.0.5   compiler_4.4.0    igraph_2.2.1      irlba_2.3.5.1     #> [21] fs_1.6.6          pkgconfig_2.0.3   htmlwidgets_1.6.4 pbapply_1.7-4     #> [25] systemfonts_1.3.1 lattice_0.22-7    digest_0.6.39     R6_2.6.1          #> [29] RANN_2.6.2        parallel_4.4.0    magrittr_2.0.4    bslib_0.9.0       #> [33] tools_4.4.0       pkgdown_2.2.0     cachem_1.1.0      desc_1.4.3"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/algorithm.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Algorithm and Mathematical Framework","text":"SCORPION implements PANDA (Passing Attributes Networks Data Assimilation) algorithm, adapted single-cell data metacell aggregation. vignette explains mathematical framework underlying algorithm.","code":""},{"path":[]},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/algorithm.html","id":"core-concept","dir":"Articles","previous_headings":"The PANDA Algorithm","what":"Core Concept","title":"Algorithm and Mathematical Framework","text":"PANDA message-passing algorithm integrates multiple data sources infer gene regulatory networks. iteratively updates three networks: Regulatory Network (W): TF → Gene relationships Co-regulatory Network (C): Gene-Gene co-expression patterns Cooperative Network (P): TF-TF cooperation patterns","code":""},{"path":[]},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/algorithm.html","id":"tanimoto-similarity","dir":"Articles","previous_headings":"The PANDA Algorithm > Mathematical Formulation","what":"1. Tanimoto Similarity","title":"Algorithm and Mathematical Framework","text":"core PANDA Tanimoto similarity function, measures overlap network neighborhoods: T(X,Y)=XYT∥X∥2+∥Y∥2−|XYT|T(X, Y) = \\frac{XY^T}{\\sqrt{\\|X\\|^2 + \\|Y\\|^2 - |XY^T|}} : - XX YY network matrices - ∥⋅∥\\|\\cdot\\| denotes Frobenius norm Illustration Tanimoto similarity networks","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/algorithm.html","id":"network-update-rules","dir":"Articles","previous_headings":"The PANDA Algorithm > Mathematical Formulation","what":"2. Network Update Rules","title":"Algorithm and Mathematical Framework","text":"iteration tt, networks updated follows: Responsibility (well TFs explain gene expression): Rt=T(Pt,Wt)R_t = T(P_t, W_t) Availability (well genes co-regulated): =T(Wt,Ct)A_t = T(W_t, C_t) Regulatory network update: Wt+1=(1−α)Wt+α⋅Rt+At2W_{t+1} = (1-\\alpha)W_t + \\alpha \\cdot \\frac{R_t + A_t}{2} Cooperative network update: Pt+1=(1−α)Pt+α⋅T(Wt,WtT)P_{t+1} = (1-\\alpha)P_t + \\alpha \\cdot T(W_t, W_t^T) Co-regulatory network update: Ct+1=(1−α)Ct+α⋅T(WtT,Wt)C_{t+1} = (1-\\alpha)C_t + \\alpha \\cdot T(W_t^T, W_t) α\\alpha learning rate.","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/algorithm.html","id":"convergence-criterion","dir":"Articles","previous_headings":"The PANDA Algorithm","what":"Convergence Criterion","title":"Algorithm and Mathematical Framework","text":"algorithm converges Hamming distance consecutive regulatory networks falls threshold: Ht=1nTF×ngene∑,j|Wt(,j)−Wt−1(,j)|H_t = \\frac{1}{n_{TF} \\times n_{gene}} \\sum_{,j} |W_t^{(,j)} - W_{t-1}^{(,j)}| Convergence PANDA algorithm","code":"# Run SCORPION and track convergence data(scorpionTest) set.seed(123)  # Run with high hamming to see more iterations result <- scorpion(   tfMotifs = scorpionTest$tf,   gexMatrix = scorpionTest$gex,   ppiNet = scorpionTest$ppi,   gammaValue = 10,   alphaValue = 0.1,   hammingValue = 0.001,   showProgress = FALSE )  # Simulated convergence curve for illustration iterations <- 0:10 hamming <- 1 * exp(-0.8 * iterations)  plot(iterations, hamming, type = \"b\", pch = 19, col = \"steelblue\",      xlab = \"Iteration\", ylab = \"Hamming Distance\",      main = \"PANDA Convergence\", ylim = c(0, 1)) abline(h = 0.001, col = \"red\", lty = 2) text(8, 0.05, \"Threshold = 0.001\", col = \"red\")"},{"path":[]},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/algorithm.html","id":"the-sparsity-problem","dir":"Articles","previous_headings":"Metacell Aggregation","what":"The Sparsity Problem","title":"Algorithm and Mathematical Framework","text":"Single-cell RNA-seq data inherently sparse due : - Technical dropout events - Low capture efficiency - Biological variability","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/algorithm.html","id":"solution-metacells","dir":"Articles","previous_headings":"Metacell Aggregation","what":"Solution: Metacells","title":"Algorithm and Mathematical Framework","text":"SCORPION addresses sparsity aggregating similar cells “metacells”: PCA dimensionality reduction variable genes k-NN graph construction PCA space Walktrap clustering identify cell communities Expression averaging within clusters Metacell aggregation concept","code":"# Illustration of metacell concept set.seed(42) n_cells <- 100 n_genes <- 50  # Simulated single-cell data (sparse) sc_data <- matrix(rpois(n_cells * n_genes, lambda = 0.5), n_genes, n_cells) sc_data[sc_data > 3] <- 3  # Simulated metacell data (denser) n_metacells <- 10 mc_data <- matrix(rpois(n_metacells * n_genes, lambda = 5), n_genes, n_metacells)  par(mfrow = c(1, 2), mar = c(4, 4, 3, 1))  # Single-cell heatmap image(t(sc_data), main = paste0(\"Single-cell (\", n_cells, \" cells)\"),       col = colorRampPalette(c(\"white\", \"navy\"))(100),       xlab = \"Cells\", ylab = \"Genes\", axes = FALSE) mtext(paste0(\"Sparsity: \", round(100*mean(sc_data == 0), 1), \"%\"), side = 1, line = 2.5)  # Metacell heatmap   image(t(mc_data), main = paste0(\"Metacells (\", n_metacells, \" metacells)\"),       col = colorRampPalette(c(\"white\", \"navy\"))(100),       xlab = \"Metacells\", ylab = \"Genes\", axes = FALSE) mtext(paste0(\"Sparsity: \", round(100*mean(mc_data == 0), 1), \"%\"), side = 1, line = 2.5)"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/algorithm.html","id":"gamma-parameter","dir":"Articles","previous_headings":"Metacell Aggregation","what":"Gamma Parameter","title":"Algorithm and Mathematical Framework","text":"gammaValue parameter controls aggregation level: γ=ncellsnmetacells\\gamma = \\frac{n_{cells}}{n_{metacells}} Higher γ = aggregation, less sparsity, lower resolution Lower γ = Less aggregation, sparsity, higher resolution","code":""},{"path":[]},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/algorithm.html","id":"double-z-score-normalization","dir":"Articles","previous_headings":"Network Normalization","what":"Double Z-score Normalization","title":"Algorithm and Mathematical Framework","text":"message passing, networks normalized using double Z-score approach: Z=Zrow+Zcol2Z = \\frac{Z_{row} + Z_{col}}{\\sqrt{2}} : Zrow=X−μrowσrowZ_{row} = \\frac{X - \\mu_{row}}{\\sigma_{row}}Zcol=X−μcolσcolZ_{col} = \\frac{X - \\mu_{col}}{\\sigma_{col}} ensures row-wise (TF) column-wise (gene) statistics considered. Effect double Z-score normalization","code":"# Illustration of normalization effect set.seed(42) raw <- matrix(rnorm(100, mean = 5, sd = 2), 10, 10) raw[1:3, ] <- raw[1:3, ] + 10  # Add row bias  # Row-wise z-score z_row <- t(scale(t(raw)))  # Column-wise z-score   z_col <- scale(raw)  # Double z-score z_double <- (z_row + z_col) / sqrt(2)  par(mfrow = c(2, 2), mar = c(2, 2, 3, 1)) image(raw, main = \"Raw Matrix\", col = colorRampPalette(c(\"blue\", \"white\", \"red\"))(100), axes = FALSE) image(z_row, main = \"Row Z-score\", col = colorRampPalette(c(\"blue\", \"white\", \"red\"))(100), axes = FALSE) image(z_col, main = \"Column Z-score\", col = colorRampPalette(c(\"blue\", \"white\", \"red\"))(100), axes = FALSE) image(z_double, main = \"Double Z-score\", col = colorRampPalette(c(\"blue\", \"white\", \"red\"))(100), axes = FALSE)"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/algorithm.html","id":"computational-complexity","dir":"Articles","previous_headings":"","what":"Computational Complexity","title":"Algorithm and Mathematical Framework","text":": - n = number TFs - m = number genes - c = number cells - g = number genes used PCA","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/algorithm.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Algorithm and Mathematical Framework","text":"Glass, K., et al. (2013). Passing Messages Biological Networks Refine Predicted Interactions. PLoS ONE. Osorio, D., et al. (2023). Population-level comparisons gene regulatory networks modeled high-throughput single-cell transcriptomics data. Nature Computational Science.","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/algorithm.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session Information","title":"Algorithm and Mathematical Framework","text":"","code":"sessionInfo() #> R version 4.4.0 (2024-04-24) #> Platform: aarch64-apple-darwin20 #> Running under: macOS 15.6.1 #>  #> Matrix products: default #> BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0 #>  #> locale: #> [1] C #>  #> time zone: Asia/Shanghai #> tzcode source: internal #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] SCORPION_1.2.1 #>  #> loaded via a namespace (and not attached): #>  [1] cli_3.6.5         knitr_1.51        rlang_1.1.7       xfun_0.56         #>  [5] otel_0.2.0        textshaping_1.0.4 jsonlite_2.0.0    htmltools_0.5.9   #>  [9] ragg_1.5.0        sass_0.4.10       rmarkdown_2.30    grid_4.4.0        #> [13] evaluate_1.0.5    jquerylib_0.1.4   fastmap_1.2.0     yaml_2.3.12       #> [17] lifecycle_1.0.5   compiler_4.4.0    igraph_2.2.1      irlba_2.3.5.1     #> [21] fs_1.6.6          pkgconfig_2.0.3   htmlwidgets_1.6.4 pbapply_1.7-4     #> [25] systemfonts_1.3.1 lattice_0.22-7    digest_0.6.39     R6_2.6.1          #> [29] RANN_2.6.2        parallel_4.4.0    magrittr_2.0.4    bslib_0.9.0       #> [33] Matrix_1.7-4      tools_4.4.0       pkgdown_2.2.0     cachem_1.1.0      #> [37] desc_1.4.3"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/network-visualization.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Network Visualization","text":"vignette demonstrates various approaches visualizing gene regulatory networks inferred SCORPION.","code":"library(SCORPION) library(Matrix) library(igraph)"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/network-visualization.html","id":"running-scorpion","dir":"Articles","previous_headings":"","what":"Running SCORPION","title":"Network Visualization","text":"","code":"data(scorpionTest) set.seed(123)  result <- scorpion(   tfMotifs = scorpionTest$tf,   gexMatrix = scorpionTest$gex,   ppiNet = scorpionTest$ppi,   gammaValue = 10,   alphaValue = 0.1,   showProgress = FALSE )"},{"path":[]},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/network-visualization.html","id":"edge-weight-distribution","dir":"Articles","previous_headings":"Network Statistics Visualization","what":"Edge Weight Distribution","title":"Network Visualization","text":"Distribution edge weights SCORPION networks","code":"par(mfrow = c(1, 3), mar = c(4, 4, 3, 1))  # Regulatory network hist(as.vector(result$regNet), breaks = 50,       main = \"Regulatory Network\",       xlab = \"Edge Weight (Z-score)\",      col = \"#3498db\", border = \"white\") abline(v = c(-2, 2), col = \"red\", lty = 2, lwd = 2)  # Co-regulatory network hist(as.vector(result$coregNet), breaks = 50,      main = \"Co-regulatory Network\",      xlab = \"Edge Weight\",      col = \"#2ecc71\", border = \"white\")  # Cooperative network hist(as.vector(result$coopNet), breaks = 50,      main = \"Cooperative Network\",      xlab = \"Edge Weight\",       col = \"#e74c3c\", border = \"white\")"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/network-visualization.html","id":"tf-targeting-statistics","dir":"Articles","previous_headings":"Network Statistics Visualization","what":"TF Targeting Statistics","title":"Network Visualization","text":"Distribution TF -degrees","code":"# Calculate TF out-degrees (number of targets per TF) regNet <- result$regNet tf_outdegree <- rowSums(abs(regNet) > 2)  # Significant edges only  # Plot par(mfrow = c(1, 2), mar = c(4, 4, 3, 1))  hist(tf_outdegree, breaks = 30,      main = \"TF Out-Degree Distribution\",      xlab = \"Number of Target Genes\",      col = \"#9b59b6\", border = \"white\")  # Top TFs by number of targets top_tfs <- sort(tf_outdegree, decreasing = TRUE)[1:20] barplot(top_tfs, las = 2, col = \"#9b59b6\",         main = \"Top 20 TFs by Number of Targets\",         ylab = \"Number of Targets\", cex.names = 0.7)"},{"path":[]},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/network-visualization.html","id":"regulatory-network-heatmap","dir":"Articles","previous_headings":"Heatmap Visualization","what":"Regulatory Network Heatmap","title":"Network Visualization","text":"Regulatory network heatmap (top TFs genes)","code":"# Select top TFs and genes for visualization top_n <- 30  # Top TFs by variance tf_var <- apply(regNet, 1, var) top_tf_idx <- order(tf_var, decreasing = TRUE)[1:top_n]  # Top genes by variance gene_var <- apply(regNet, 2, var) top_gene_idx <- order(gene_var, decreasing = TRUE)[1:top_n]  # Subset network subnet <- regNet[top_tf_idx, top_gene_idx]  # Create heatmap heatmap(as.matrix(subnet),          col = colorRampPalette(c(\"#2980b9\", \"white\", \"#c0392b\"))(100),         scale = \"none\",         main = \"Top TF-Gene Regulatory Relationships\",         margins = c(8, 8),         cexRow = 0.6, cexCol = 0.6)"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/network-visualization.html","id":"tf-cooperation-heatmap","dir":"Articles","previous_headings":"Heatmap Visualization","what":"TF Cooperation Heatmap","title":"Network Visualization","text":"TF cooperation network heatmap","code":"# Select top cooperating TFs coopNet <- result$coopNet diag(coopNet) <- 0  tf_coop_degree <- rowSums(abs(coopNet) > quantile(abs(coopNet), 0.95)) top_coop_idx <- order(tf_coop_degree, decreasing = TRUE)[1:min(40, nrow(coopNet))]  coop_subnet <- coopNet[top_coop_idx, top_coop_idx]  heatmap(as.matrix(coop_subnet),         col = colorRampPalette(c(\"#27ae60\", \"white\", \"#e74c3c\"))(100),         scale = \"none\", symm = TRUE,         main = \"TF Cooperation Network\",         margins = c(8, 8),         cexRow = 0.6, cexCol = 0.6)"},{"path":[]},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/network-visualization.html","id":"building-igraph-network","dir":"Articles","previous_headings":"Network Graph Visualization","what":"Building igraph Network","title":"Network Visualization","text":"","code":"# Create edge list from regulatory network threshold <- 2  # Z-score threshold  edges <- which(abs(regNet) > threshold, arr.ind = TRUE) if(nrow(edges) > 0) {   edge_df <- data.frame(     from = rownames(regNet)[edges[,1]],     to = colnames(regNet)[edges[,2]],     weight = regNet[edges],     stringsAsFactors = FALSE   )      # Limit to top edges for visualization   edge_df <- edge_df[order(-abs(edge_df$weight)), ]   edge_df <- head(edge_df, 200)      # Create igraph object (without weight attribute for layout compatibility)   g <- graph_from_data_frame(edge_df[, c(\"from\", \"to\")], directed = TRUE)      # Node attributes   V(g)$type <- ifelse(V(g)$name %in% rownames(regNet), \"TF\", \"Gene\")   V(g)$color <- ifelse(V(g)$type == \"TF\", \"#e74c3c\", \"#3498db\")   V(g)$size <- ifelse(V(g)$type == \"TF\", 8, 5)      # Edge attributes (store original weight for coloring)   E(g)$orig_weight <- edge_df$weight   E(g)$color <- ifelse(edge_df$weight > 0, \"#27ae60\", \"#c0392b\")   E(g)$width <- abs(edge_df$weight) / max(abs(edge_df$weight)) * 2 + 0.5      cat(\"Network has\", vcount(g), \"nodes and\", ecount(g), \"edges\\n\") } else {   cat(\"No significant edges found with threshold =\", threshold, \"\\n\") } #> Network has 292 nodes and 200 edges"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/network-visualization.html","id":"network-layout-and-plotting","dir":"Articles","previous_headings":"Network Graph Visualization","what":"Network Layout and Plotting","title":"Network Visualization","text":"Gene regulatory network visualization","code":"if(exists(\"g\") && vcount(g) > 0) {   # Use layout without weight dependency   set.seed(42)   layout <- layout_nicely(g)      # Plot   par(mar = c(0, 0, 2, 0))   plot(g,         layout = layout,        vertex.label = ifelse(degree(g) > 5, V(g)$name, NA),        vertex.label.cex = 0.6,        vertex.label.color = \"black\",        vertex.frame.color = NA,        edge.arrow.size = 0.3,        main = \"SCORPION Gene Regulatory Network\")      legend(\"bottomleft\",           legend = c(\"TF\", \"Gene\", \"Activation\", \"Repression\"),          col = c(\"#e74c3c\", \"#3498db\", \"#27ae60\", \"#c0392b\"),          pch = c(19, 19, NA, NA),          lty = c(NA, NA, 1, 1),          lwd = 2, bty = \"n\") } else {   plot.new()   text(0.5, 0.5, \"No network to display\", cex = 1.5) }"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/network-visualization.html","id":"subnetwork-for-specific-tf","dir":"Articles","previous_headings":"Network Graph Visualization","what":"Subnetwork for Specific TF","title":"Network Visualization","text":"Subnetwork specific TF","code":"if(exists(\"g\") && vcount(g) > 0) {   # Select a TF with many targets   tf_degrees <- degree(g, mode = \"out\")   tf_names <- names(tf_degrees)[tf_degrees > 0]      if(length(tf_names) > 0) {     # Select top TF     top_tf <- tf_names[which.max(tf_degrees[tf_names])]          # Get neighbors     neighbors_idx <- neighbors(g, top_tf, mode = \"out\")     subgraph_nodes <- c(top_tf, names(neighbors_idx))          if(length(subgraph_nodes) > 1) {       # Create subgraph       subg <- induced_subgraph(g, subgraph_nodes)              # Plot       par(mar = c(0, 0, 2, 0))       plot(subg,            layout = layout_as_star(subg, center = top_tf),            vertex.label.cex = 0.8,            vertex.label.color = \"black\",            vertex.frame.color = NA,            edge.arrow.size = 0.5,            main = paste(\"Target genes of\", top_tf))     }   } } else {   plot.new()   text(0.5, 0.5, \"No network to display\", cex = 1.5) }"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/network-visualization.html","id":"circular-network-plot","dir":"Articles","previous_headings":"","what":"Circular Network Plot","title":"Network Visualization","text":"Circular network visualization","code":"if(exists(\"edge_df\") && nrow(edge_df) > 0) {   # Create simplified network for circular layout   edge_df_simple <- head(edge_df[order(-abs(edge_df$weight)), ], 100)   g_simple <- graph_from_data_frame(edge_df_simple, directed = TRUE)      V(g_simple)$type <- ifelse(V(g_simple)$name %in% rownames(regNet), \"TF\", \"Gene\")   V(g_simple)$color <- ifelse(V(g_simple)$type == \"TF\", \"#e74c3c\", \"#3498db\")      # Order nodes: TFs first, then genes   node_order <- order(V(g_simple)$type, decreasing = TRUE)   g_simple <- permute(g_simple, node_order)      # Circular layout   par(mar = c(0, 0, 2, 0))   plot(g_simple,        layout = layout_in_circle(g_simple),        vertex.size = 6,        vertex.label.cex = 0.5,        vertex.label.dist = 1,        vertex.frame.color = NA,        edge.arrow.size = 0.2,        edge.curved = 0.2,        main = \"Circular Network Layout\") } else {   plot.new()   text(0.5, 0.5, \"No network to display\", cex = 1.5) }"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/network-visualization.html","id":"network-centrality-analysis","dir":"Articles","previous_headings":"","what":"Network Centrality Analysis","title":"Network Visualization","text":"Network centrality measures","code":"if(exists(\"g\") && vcount(g) > 0) {   # Calculate centrality measures   deg_in <- degree(g, mode = \"in\")   deg_out <- degree(g, mode = \"out\")   between <- betweenness(g)   pr <- page_rank(g)$vector      # Create summary   centrality_df <- data.frame(     Node = V(g)$name,     Type = V(g)$type,     InDegree = deg_in,     OutDegree = deg_out,     Betweenness = between,     PageRank = pr   )      # Top nodes by different measures   par(mfrow = c(2, 2), mar = c(8, 4, 3, 1))      # Top by in-degree (most regulated genes)   top_in <- head(centrality_df[order(-centrality_df$InDegree), ], 15)   if(nrow(top_in) > 0) {     barplot(top_in$InDegree, names.arg = top_in$Node, las = 2,              col = \"#3498db\", main = \"Top Regulated Genes\",             ylab = \"In-Degree\", cex.names = 0.7)   }      # Top by out-degree (most active TFs)   top_out <- head(centrality_df[order(-centrality_df$OutDegree), ], 15)   if(nrow(top_out) > 0) {     barplot(top_out$OutDegree, names.arg = top_out$Node, las = 2,             col = \"#e74c3c\", main = \"Most Active TFs\",             ylab = \"Out-Degree\", cex.names = 0.7)   }      # Top by betweenness   top_bet <- head(centrality_df[order(-centrality_df$Betweenness), ], 15)   if(nrow(top_bet) > 0) {     barplot(top_bet$Betweenness, names.arg = top_bet$Node, las = 2,             col = \"#9b59b6\", main = \"Hub Nodes (Betweenness)\",             ylab = \"Betweenness\", cex.names = 0.7)   }      # Top by PageRank   top_pr <- head(centrality_df[order(-centrality_df$PageRank), ], 15)   if(nrow(top_pr) > 0) {     barplot(top_pr$PageRank, names.arg = top_pr$Node, las = 2,             col = \"#f39c12\", main = \"Important Nodes (PageRank)\",             ylab = \"PageRank\", cex.names = 0.7)   } } else {   par(mfrow = c(1, 1))   plot.new()   text(0.5, 0.5, \"No network to display\", cex = 1.5) }"},{"path":[]},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/network-visualization.html","id":"export-to-cytoscape","dir":"Articles","previous_headings":"Exporting Networks","what":"Export to Cytoscape","title":"Network Visualization","text":"","code":"# Export edge list for Cytoscape write.csv(edge_df, \"scorpion_network.csv\", row.names = FALSE)  # Export node attributes node_attrs <- data.frame(   Node = c(rownames(regNet), colnames(regNet)),   Type = c(rep(\"TF\", nrow(regNet)), rep(\"Gene\", ncol(regNet))) ) write.csv(node_attrs, \"scorpion_nodes.csv\", row.names = FALSE)"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/network-visualization.html","id":"export-to-graphml","dir":"Articles","previous_headings":"Exporting Networks","what":"Export to GraphML","title":"Network Visualization","text":"","code":"# Export as GraphML for Cytoscape/Gephi write_graph(g, \"scorpion_network.graphml\", format = \"graphml\")"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/network-visualization.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"Network Visualization","text":"Key visualization approaches SCORPION networks: Heatmaps: Good showing global patterns Network graphs: Show topology hub nodes Centrality plots: Identify key regulators Subnetworks: Focus specific TFs pathways","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/network-visualization.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session Information","title":"Network Visualization","text":"","code":"sessionInfo() #> R version 4.4.0 (2024-04-24) #> Platform: aarch64-apple-darwin20 #> Running under: macOS 15.6.1 #>  #> Matrix products: default #> BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0 #>  #> locale: #> [1] C #>  #> time zone: Asia/Shanghai #> tzcode source: internal #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] igraph_2.2.1   Matrix_1.7-4   SCORPION_1.2.1 #>  #> loaded via a namespace (and not attached): #>  [1] cli_3.6.5         knitr_1.51        rlang_1.1.7       xfun_0.56         #>  [5] otel_0.2.0        textshaping_1.0.4 jsonlite_2.0.0    htmltools_0.5.9   #>  [9] ragg_1.5.0        sass_0.4.10       rmarkdown_2.30    grid_4.4.0        #> [13] evaluate_1.0.5    jquerylib_0.1.4   fastmap_1.2.0     yaml_2.3.12       #> [17] lifecycle_1.0.5   compiler_4.4.0    irlba_2.3.5.1     fs_1.6.6          #> [21] pkgconfig_2.0.3   htmlwidgets_1.6.4 pbapply_1.7-4     systemfonts_1.3.1 #> [25] lattice_0.22-7    digest_0.6.39     R6_2.6.1          RANN_2.6.2        #> [29] parallel_4.4.0    magrittr_2.0.4    bslib_0.9.0       tools_4.4.0       #> [33] pkgdown_2.2.0     cachem_1.1.0      desc_1.4.3"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/quick-start.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Quick Start Guide","text":"SCORPION (Single-Cell Oriented Reconstruction PANDA Individually Optimized Networks) computational framework inferring cell-type-specific gene regulatory networks (GRNs) single-cell RNA sequencing data. vignette provides quick introduction using SCORPION gene regulatory network inference.","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/quick-start.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Quick Start Guide","text":"","code":"# From R-universe (Recommended) install.packages(\"SCORPION\", repos = \"https://zaoqu-liu.r-universe.dev\")  # From GitHub remotes::install_github(\"Zaoqu-Liu/SCORPION\")"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/quick-start.html","id":"loading-the-package","dir":"Articles","previous_headings":"","what":"Loading the Package","title":"Quick Start Guide","text":"","code":"library(SCORPION) library(Matrix)"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/quick-start.html","id":"example-data","dir":"Articles","previous_headings":"","what":"Example Data","title":"Quick Start Guide","text":"SCORPION comes example data consisting : Gene expression matrix: sparse matrix genes rows cells columns TF-target motif prior: data frame describing transcription factor binding sites Protein-protein interactions: data frame known TF-TF interactions","code":"# Load example data data(scorpionTest)  # Examine the structure cat(\"Gene expression matrix:\", nrow(scorpionTest$gex), \"genes x\",      ncol(scorpionTest$gex), \"cells\\n\") #> Gene expression matrix: 230 genes x 80 cells cat(\"TF-target motif edges:\", nrow(scorpionTest$tf), \"\\n\") #> TF-target motif edges: 4485 cat(\"Protein-protein interactions:\", nrow(scorpionTest$ppi), \"\\n\") #> Protein-protein interactions: 12754"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/quick-start.html","id":"running-scorpion","dir":"Articles","previous_headings":"","what":"Running SCORPION","title":"Quick Start Guide","text":"main function scorpion() takes three inputs returns three networks:","code":"# Run SCORPION set.seed(123) result <- scorpion(   tfMotifs = scorpionTest$tf,      # TF-target motif prior   gexMatrix = scorpionTest$gex,    # Gene expression matrix   ppiNet = scorpionTest$ppi,       # Protein-protein interactions   gammaValue = 10,                 # Metacell aggregation ratio   alphaValue = 0.1,                # Learning rate   hammingValue = 0.001             # Convergence threshold )"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/quick-start.html","id":"output-structure","dir":"Articles","previous_headings":"","what":"Output Structure","title":"Quick Start Guide","text":"SCORPION returns list containing:","code":"# Network dimensions cat(\"Regulatory network:\", dim(result$regNet)[1], \"TFs x\",      dim(result$regNet)[2], \"genes\\n\") #> Regulatory network: 783 TFs x 214 genes cat(\"Co-regulatory network:\", dim(result$coregNet)[1], \"x\",      dim(result$coregNet)[2], \"genes\\n\") #> Co-regulatory network: 214 x 214 genes cat(\"Cooperative network:\", dim(result$coopNet)[1], \"x\",      dim(result$coopNet)[2], \"TFs\\n\") #> Cooperative network: 783 x 783 TFs  # Summary statistics cat(\"\\nNumber of genes:\", result$numGenes, \"\\n\") #>  #> Number of genes: 214 cat(\"Number of TFs:\", result$numTFs, \"\\n\") #> Number of TFs: 783 cat(\"Number of edges:\", result$numEdges, \"\\n\") #> Number of edges: 167562"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/quick-start.html","id":"extracting-top-regulatory-edges","dir":"Articles","previous_headings":"","what":"Extracting Top Regulatory Edges","title":"Quick Start Guide","text":"","code":"# Get regulatory network regNet <- result$regNet  # Find top positive regulators top_edges <- which(regNet > 2, arr.ind = TRUE) if(nrow(top_edges) > 0) {   top_df <- data.frame(     TF = rownames(regNet)[top_edges[,1]],     Gene = colnames(regNet)[top_edges[,2]],     Score = regNet[top_edges]   )   top_df <- top_df[order(-top_df$Score), ]   head(top_df, 10) } #>          TF     Gene    Score #> 289   ESRRB      CA2 22.59849 #> 999    HSF5    FCRLA 17.98239 #> 1320   RFX5 HLA-DQA1 17.29737 #> 3265  ZNF57    TTC38 16.70364 #> 2504  ZNF18    PTCRA 16.49227 #> 3008 DMRTB1    TCL1A 16.48504 #> 1090   FLI1      GP9 16.41962 #> 446  PHOX2B     CD68 16.03947 #> 2344  GATA1      PF4 15.97612 #> 444    ESR2     CD68 15.89983"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/quick-start.html","id":"visualizing-network-statistics","dir":"Articles","previous_headings":"","what":"Visualizing Network Statistics","title":"Quick Start Guide","text":"Distribution regulatory edge weights","code":"# Edge weight distribution hist(as.vector(result$regNet), breaks = 50,       main = \"Distribution of Regulatory Edge Weights\",      xlab = \"Edge Weight (Z-score)\",       col = \"steelblue\", border = \"white\") abline(v = c(-2, 2), col = \"red\", lty = 2)"},{"path":"https://zaoqu-liu.github.io/SCORPION/articles/quick-start.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session Information","title":"Quick Start Guide","text":"","code":"sessionInfo() #> R version 4.4.0 (2024-04-24) #> Platform: aarch64-apple-darwin20 #> Running under: macOS 15.6.1 #>  #> Matrix products: default #> BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0 #>  #> locale: #> [1] C #>  #> time zone: Asia/Shanghai #> tzcode source: internal #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] Matrix_1.7-4   SCORPION_1.2.1 #>  #> loaded via a namespace (and not attached): #>  [1] cli_3.6.5         knitr_1.51        rlang_1.1.7       xfun_0.56         #>  [5] otel_0.2.0        textshaping_1.0.4 jsonlite_2.0.0    htmltools_0.5.9   #>  [9] ragg_1.5.0        sass_0.4.10       rmarkdown_2.30    grid_4.4.0        #> [13] evaluate_1.0.5    jquerylib_0.1.4   fastmap_1.2.0     yaml_2.3.12       #> [17] lifecycle_1.0.5   compiler_4.4.0    codetools_0.2-20  igraph_2.2.1      #> [21] irlba_2.3.5.1     fs_1.6.6          pkgconfig_2.0.3   htmlwidgets_1.6.4 #> [25] pbapply_1.7-4     systemfonts_1.3.1 lattice_0.22-7    digest_0.6.39     #> [29] R6_2.6.1          RANN_2.6.2        parallel_4.4.0    magrittr_2.0.4    #> [33] bslib_0.9.0       tools_4.4.0       pkgdown_2.2.0     cachem_1.1.0      #> [37] desc_1.4.3"},{"path":"https://zaoqu-liu.github.io/SCORPION/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Zaoqu Liu. Author, maintainer. Daniel Osorio. Author. Marieke L. Kuijjer. Author.","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Liu Z, Osorio D, Kuijjer M (2026). SCORPION: Single Cell Oriented Reconstruction PANDA Individual Optimized Networks. R package version 1.2.1, https://github.com/Zaoqu-Liu/SCORPION.","code":"@Manual{,   title = {SCORPION: Single Cell Oriented Reconstruction of PANDA Individual Optimized Networks},   author = {Zaoqu Liu and Daniel Osorio and Marieke L. Kuijjer},   year = {2026},   note = {R package version 1.2.1},   url = {https://github.com/Zaoqu-Liu/SCORPION}, }"},{"path":[]},{"path":"https://zaoqu-liu.github.io/SCORPION/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"SCORPION - Single-Cell Gene Regulatory Network Inference","text":"SCORPION (Single-Cell Oriented Reconstruction PANDA Individually Optimized Gene Regulatory Networks) computational framework inferring cell-type-specific gene regulatory networks (GRNs) single-cell RNA sequencing (scRNA-seq) data.","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/index.html","id":"motivation","dir":"","previous_headings":"","what":"Motivation","title":"SCORPION - Single-Cell Gene Regulatory Network Inference","text":"Single-cell transcriptomics revolutionized understanding cellular heterogeneity, yet inherent sparsity technical noise scRNA-seq data pose significant challenges accurate gene regulatory network inference. SCORPION addresses limitations metacell-based coarse-graining strategy preserves biological signal reducing technical artifacts.","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/index.html","id":"method","dir":"","previous_headings":"","what":"Method","title":"SCORPION - Single-Cell Gene Regulatory Network Inference","text":"SCORPION integrates three complementary data modalities reconstruct transcriptome-wide GRNs: Transcription factor (TF) binding motifs - sequence-based prior knowledge potential regulatory relationships Protein-protein interactions (PPI) - physical interactions transcription factors Gene expression profiles - cell-type-specific transcriptional states algorithm employs PANDA (Passing Attributes Networks Data Assimilation) message-passing framework, iteratively refines network edge weights Tanimoto similarity-based updates convergence.","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/index.html","id":"key-features","dir":"","previous_headings":"Method","what":"Key Features","title":"SCORPION - Single-Cell Gene Regulatory Network Inference","text":"Metacell aggregation: Reduces data sparsity grouping transcriptionally similar cells using graph-based clustering PCA space Multi-modal integration: Combines transcriptomic data prior biological knowledge (TF motifs, PPI networks) Comparable networks: Generates fully-connected, weighted, directed GRNs suitable population-level comparative analyses Scalable: Efficient implementation supporting CPU GPU computation","code":""},{"path":[]},{"path":"https://zaoqu-liu.github.io/SCORPION/index.html","id":"from-r-universe-recommended","dir":"","previous_headings":"Installation","what":"From R-universe (Recommended)","title":"SCORPION - Single-Cell Gene Regulatory Network Inference","text":"","code":"install.packages(\"SCORPION\", repos = \"https://zaoqu-liu.r-universe.dev\")"},{"path":"https://zaoqu-liu.github.io/SCORPION/index.html","id":"from-cran","dir":"","previous_headings":"Installation","what":"From CRAN","title":"SCORPION - Single-Cell Gene Regulatory Network Inference","text":"","code":"install.packages(\"SCORPION\")"},{"path":"https://zaoqu-liu.github.io/SCORPION/index.html","id":"from-github-development-version","dir":"","previous_headings":"Installation","what":"From GitHub (Development Version)","title":"SCORPION - Single-Cell Gene Regulatory Network Inference","text":"","code":"if (!requireNamespace(\"remotes\", quietly = TRUE))     install.packages(\"remotes\") remotes::install_github(\"Zaoqu-Liu/SCORPION\")"},{"path":"https://zaoqu-liu.github.io/SCORPION/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick Start","title":"SCORPION - Single-Cell Gene Regulatory Network Inference","text":"","code":"library(SCORPION)  # Load example data data(scorpionTest)  # Infer gene regulatory network grn <- scorpion(     tfMotifs = scorpionTest$tf,      # TF-target motif prior     gexMatrix = scorpionTest$gex,    # Gene expression matrix (genes × cells)     ppiNet = scorpionTest$ppi,       # Protein-protein interactions     alphaValue = 0.1                 # Learning rate (default) )"},{"path":[]},{"path":"https://zaoqu-liu.github.io/SCORPION/index.html","id":"output","dir":"","previous_headings":"","what":"Output","title":"SCORPION - Single-Cell Gene Regulatory Network Inference","text":"SCORPION returns list containing: Edge weights represent Z-scores indicating strength regulatory relationships.","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/index.html","id":"example-workflow","dir":"","previous_headings":"","what":"Example Workflow","title":"SCORPION - Single-Cell Gene Regulatory Network Inference","text":"","code":"# Load package and data library(SCORPION) data(scorpionTest)  # Run SCORPION result <- scorpion(     tfMotifs = scorpionTest$tf,     gexMatrix = scorpionTest$gex,     ppiNet = scorpionTest$ppi,     gammaValue = 10,        # Metacell graining level     nPC = 25,               # Principal components for clustering     alphaValue = 0.1,       # Learning rate     hammingValue = 0.001    # Convergence threshold )  # Examine output dim(result$regNet)    # Regulatory network dimensions # [1] 783 214  # Extract top regulatory edges regNet <- result$regNet top_edges <- which(abs(regNet) > 2, arr.ind = TRUE)"},{"path":[]},{"path":"https://zaoqu-liu.github.io/SCORPION/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"SCORPION - Single-Cell Gene Regulatory Network Inference","text":"use SCORPION research, please cite: Osorio, D., Capasso, ., Eckhardt, S. G., Giri, U., Somma, ., Pitts, T. M., … & Kuijjer, M. L. (2023). Population-level comparisons gene regulatory networks modeled high-throughput single-cell transcriptomics data. Nature Computational Science. DOI: 10.1038/s43588-023-00558-w","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/index.html","id":"related-resources","dir":"","previous_headings":"","what":"Related Resources","title":"SCORPION - Single-Cell Gene Regulatory Network Inference","text":"netZooR - Network Zoo package collection PANDA - Original PANDA algorithm","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/index.html","id":"contributing","dir":"","previous_headings":"","what":"Contributing","title":"SCORPION - Single-Cell Gene Regulatory Network Inference","text":"welcome contributions! Please submit issues pull requests GitHub.","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"SCORPION - Single-Cell Gene Regulatory Network Inference","text":"GPL-3 © Zaoqu Liu","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/reference/scorpion.html","id":null,"dir":"Reference","previous_headings":"","what":"Constructs PANDA gene regulatory networks from single-cell gene expression data — scorpion","title":"Constructs PANDA gene regulatory networks from single-cell gene expression data — scorpion","text":"Constructs gene regulatory networks single-cell gene expression data using PANDA (Passing Attributes Networks Data Assimilation) algorithm.","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/reference/scorpion.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Constructs PANDA gene regulatory networks from single-cell gene expression data — scorpion","text":"","code":"scorpion(   tfMotifs = NULL,   gexMatrix,   ppiNet = NULL,   computingEngine = \"cpu\",   nCores = 1,   gammaValue = 10,   nPC = 25,   assocMethod = \"pearson\",   alphaValue = 0.1,   hammingValue = 0.001,   nIter = Inf,   outNet = c(\"regulatory\", \"coregulatory\", \"cooperative\"),   zScaling = TRUE,   showProgress = TRUE,   randomizationMethod = \"None\",   scaleByPresent = FALSE,   filterExpr = FALSE )"},{"path":"https://zaoqu-liu.github.io/SCORPION/reference/scorpion.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Constructs PANDA gene regulatory networks from single-cell gene expression data — scorpion","text":"tfMotifs motif dataset, data.frame matrix containing 3 columns. row describes motif associated transcription factor (column 1) gene (column 2) score (column 3) motif. gexMatrix expression dataset, genes rows barcodes (cells) columns. ppiNet Protein-Protein-Interaction dataset, data.frame matrix containing 3 columns. row describes protein-protein interaction transcription factor 1(column 1), transcription factor 2 (column 2) score (column 3) interaction. computingEngine Either 'cpu' 'gpu' nCores Number processors used BLAS MPI active. gammaValue Graining level data (proportion number single cells initial dataset number super-cells final dataset) nPC Number principal components use construction single-cell kNN network. assocMethod Association method. Must one 'pearson', 'spearman' 'pcNet'. alphaValue Value used update variable. hammingValue Value terminate process based Hamming distance. nIter Sets maximum number iterations PANDA can run exiting. outNet vector containing networks return. Options include \"regulatory\", \"coregulatory\", \"cooperative\". zScaling Boolean indicate use Z-Scores output. False use [0,1] scale. showProgress Boolean indicate printing output algorithm progress. randomizationMethod Method randomize gene expression matrix. Default \"None\". Must one \"None\", \"within.gene\", \".genes\". \"within.gene\" randomization scrambles row gene expression matrix, \".gene\" scrambles gene labels. scaleByPresent Boolean indicate scaling correlations percentage positive samples. filterExpr Boolean indicate wheter remove genes 0 expression across cells GEX input.","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/reference/scorpion.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Constructs PANDA gene regulatory networks from single-cell gene expression data — scorpion","text":"list matrices describing networks achieved convergence PANDA algorithm.","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/reference/scorpion.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Constructs PANDA gene regulatory networks from single-cell gene expression data — scorpion","text":"Daniel Osorio <daniecos@uio.>","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/reference/scorpion.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Constructs PANDA gene regulatory networks from single-cell gene expression data — scorpion","text":"","code":"# Loading example data data(scorpionTest)  # The structure of the data str(scorpionTest) #> List of 3 #>  $ gex:Formal class 'dgCMatrix' [package \"Matrix\"] with 6 slots #>   .. ..@ i       : int [1:4456] 1 5 8 11 22 30 33 34 36 38 ... #>   .. ..@ p       : int [1:81] 0 47 99 149 205 258 306 342 387 423 ... #>   .. ..@ Dim     : int [1:2] 230 80 #>   .. ..@ Dimnames:List of 2 #>   .. .. ..$ : chr [1:230] \"MS4A1\" \"CD79B\" \"CD79A\" \"HLA-DRA\" ... #>   .. .. ..$ : chr [1:80] \"ATGCCAGAACGACT\" \"CATGGCCTGTGCAT\" \"GAACCTGATGAACC\" \"TGACTGGATTCTCA\" ... #>   .. ..@ x       : num [1:4456] 1 1 3 1 1 4 1 5 1 1 ... #>   .. ..@ factors : list() #>  $ tf :'data.frame':\t4485 obs. of  3 variables: #>   ..$ tf    : chr [1:4485] \"ADNP\" \"ADNP\" \"ADNP\" \"AEBP2\" ... #>   ..$ target: chr [1:4485] \"PRF1\" \"TMEM40\" \"TNFRSF1B\" \"CFP\" ... #>   ..$ mor   : num [1:4485] 1 1 1 1 1 1 1 1 1 1 ... #>  $ ppi:'data.frame':\t12754 obs. of  3 variables: #>   ..$ protein1      : chr [1:12754] \"ADNP\" \"ADNP\" \"ADNP\" \"AEBP2\" ... #>   ..$ protein2      : chr [1:12754] \"ZBTB14\" \"NFIA\" \"CDC5L\" \"YY1\" ... #>   ..$ combined_score: num [1:12754] 0.769 0.64 0.581 0.597 0.54 0.753 0.659 0.548 0.59 0.654 ...  # List of 3 # $ gex:Formal class 'dgCMatrix' [package \"Matrix\"] with 6 slots # .. ..@ i       : int [1:4456] 1 5 8 11 22 30 33 34 36 38 ... # .. ..@ p       : int [1:81] 0 47 99 149 205 258 306 342 387 423 ... # .. ..@ Dim     : int [1:2] 230 80 # .. ..@ Dimnames:List of 2 # .. .. ..$ : chr [1:230] \"MS4A1\" \"CD79B\" \"CD79A\" \"HLA-DRA\" ... # .. .. ..$ : chr [1:80] \"ATGCCAGAACGACT\" \"CATGGCCTGTGCAT\" \"GAACCTGATGAACC\" \"TGACTGGATTCTCA\" ... # .. ..@ x       : num [1:4456] 1 1 3 1 1 4 1 5 1 1 ... # .. ..@ factors : list() # $ tf :'data.frame':  4485 obs. of  3 variables: #   ..$ tf    : chr [1:4485] \"ADNP\" \"ADNP\" \"ADNP\" \"AEBP2\" ... # ..$ target: chr [1:4485] \"PRF1\" \"TMEM40\" \"TNFRSF1B\" \"CFP\" ... # ..$ mor   : num [1:4485] 1 1 1 1 1 1 1 1 1 1 ... # $ ppi:'data.frame':  12754 obs. of  3 variables: #   ..$ X.node1       : chr [1:12754] \"ADNP\" \"ADNP\" \"ADNP\" \"AEBP2\" ... # ..$ node2         : chr [1:12754] \"ZBTB14\" \"NFIA\" \"CDC5L\" \"YY1\" ... # ..$ combined_score: num [1:12754] 0.769 0.64 0.581 0.597 0.54 0.753 0.659 0.548 0.59 0.654 ...  # Running SCORPION with large alphaValue for testing purposes. scorpionOutput <- scorpion(tfMotifs = scorpionTest$tf,                            gexMatrix = scorpionTest$gex,                            ppiNet = scorpionTest$ppi,                            alphaValue = 0.8) #>  #> -- SCORPION -------------------------------------------------------------------- #> v Initializing and validating #> v Verified sufficient samples #> i Normalizing networks #> i Learning Network #> i Using tanimoto similarity #> Iteration 0: hamming distance = 0.73486 #> Iteration 1: hamming distance = 0.22155 #> Iteration 2: hamming distance = 0.078 #> Iteration 3: hamming distance = 0.01924 #> Iteration 4: hamming distance = 0.00414 #> Iteration 5: hamming distance = 0.00085 #> v Successfully ran SCORPION on 214 Genes and 783 TFs #> Iteration 5: hamming distance = 0.00085  #> i Time elapsed: 2.5 seconds #> Iteration 5: hamming distance = 0.00085   # -- SCORPION -------------------------------------------------------------------------------------- # + Initializing and validating # + Verified sufficient samples # i Normalizing networks # i Learning Network # i Using tanimoto similarity # + Successfully ran SCORPION on 214 Genes and 783 TFs  # Structure of the output. str(scorpionOutput) #> List of 6 #>  $ regNet  : num [1:783, 1:214] -0.413 1.517 -1.311 0.364 -1.041 ... #>   ..- attr(*, \"dimnames\")=List of 2 #>   .. ..$ : chr [1:783] \"ADNP\" \"AEBP2\" \"AIRE\" \"ALX1\" ... #>   .. ..$ : chr [1:214] \"ACAP1\" \"ACRBP\" \"ACSM3\" \"ADAR\" ... #>  $ coregNet: num [1:214, 1:214] 7.07e+06 -4.06 1.76e+01 -1.16e+01 -1.62e+01 ... #>   ..- attr(*, \"dimnames\")=List of 2 #>   .. ..$ : chr [1:214] \"ACAP1\" \"ACRBP\" \"ACSM3\" \"ADAR\" ... #>   .. ..$ : chr [1:214] \"ACAP1\" \"ACRBP\" \"ACSM3\" \"ADAR\" ... #>  $ coopNet : num [1:783, 1:783] 5.65e+06 -5.16 -3.79 -3.63 2.94 ... #>   ..- attr(*, \"dimnames\")=List of 2 #>   .. ..$ : chr [1:783] \"ADNP\" \"AEBP2\" \"AIRE\" \"ALX1\" ... #>   .. ..$ : chr [1:783] \"ADNP\" \"AEBP2\" \"AIRE\" \"ALX1\" ... #>  $ numGenes: int 214 #>  $ numTFs  : int 783 #>  $ numEdges: int 167562  # List of 6 # $ regNet  :Formal class 'dgeMatrix' [package \"Matrix\"] with 4 slots # .. ..@ x       : num [1:167562] -0.413 1.517 -1.311 0.364 -1.041 ... # .. ..@ Dim     : int [1:2] 783 214 # .. ..@ Dimnames:List of 2 # .. .. ..$ : chr [1:783] \"ADNP\" \"AEBP2\" \"AIRE\" \"ALX1\" ... # .. .. ..$ : chr [1:214] \"ACAP1\" \"ACRBP\" \"ACSM3\" \"ADAR\" ... # .. ..@ factors : list() # $ coregNet:Formal class 'dgeMatrix' [package \"Matrix\"] with 4 slots # .. ..@ x       : num [1:45796] 7.07e+06 -4.06 1.76e+01 -1.16e+01 -1.62e+01 ... # .. ..@ Dim     : int [1:2] 214 214 # .. ..@ Dimnames:List of 2 # .. .. ..$ : chr [1:214] \"ACAP1\" \"ACRBP\" \"ACSM3\" \"ADAR\" ... # .. .. ..$ : chr [1:214] \"ACAP1\" \"ACRBP\" \"ACSM3\" \"ADAR\" ... # .. ..@ factors : list() # $ coopNet :Formal class 'dgeMatrix' [package \"Matrix\"] with 4 slots # .. ..@ x       : num [1:613089] 5.65e+06 -5.16 -3.79 -3.63 2.94 ... # .. ..@ Dim     : int [1:2] 783 783 # .. ..@ Dimnames:List of 2 # .. .. ..$ : chr [1:783] \"ADNP\" \"AEBP2\" \"AIRE\" \"ALX1\" ... # .. .. ..$ : chr [1:783] \"ADNP\" \"AEBP2\" \"AIRE\" \"ALX1\" ... # .. ..@ factors : list() # $ numGenes: int 214 # $ numTFs  : int 783 # $ numEdges: int 167562"},{"path":"https://zaoqu-liu.github.io/SCORPION/reference/scorpionTest.html","id":null,"dir":"Reference","previous_headings":"","what":"Example single-cell gene expression, motif, and ppi data — scorpionTest","title":"Example single-cell gene expression, motif, and ppi data — scorpionTest","text":"data list containing three objects. motif data.frame describes set pairwise connections specific known sequence motif transcription factor found upstream corresponding gene. expression dgCMatrix set 230 gene expression levels measured across 80 cells. Finally, ppi data.frame describes set known pairwise protein-protein interactions.","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/reference/scorpionTest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example single-cell gene expression, motif, and ppi data — scorpionTest","text":"","code":"data(scorpionTest)"},{"path":"https://zaoqu-liu.github.io/SCORPION/reference/scorpionTest.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example single-cell gene expression, motif, and ppi data — scorpionTest","text":"list containing three datasets. gex subsetted version 10X Genomics' 3k PBMC dataset provided Seurat package. tf Subset transcription-factor target gene list provided dorothea package Homo sapiens. ppi known protein-protein interactions combined score downloaded STRING database","code":""},{"path":"https://zaoqu-liu.github.io/SCORPION/reference/scorpionTest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Example single-cell gene expression, motif, and ppi data — scorpionTest","text":"","code":"# Loading example data data(scorpionTest)  # The structure of the data str(scorpionTest) #> List of 3 #>  $ gex:Formal class 'dgCMatrix' [package \"Matrix\"] with 6 slots #>   .. ..@ i       : int [1:4456] 1 5 8 11 22 30 33 34 36 38 ... #>   .. ..@ p       : int [1:81] 0 47 99 149 205 258 306 342 387 423 ... #>   .. ..@ Dim     : int [1:2] 230 80 #>   .. ..@ Dimnames:List of 2 #>   .. .. ..$ : chr [1:230] \"MS4A1\" \"CD79B\" \"CD79A\" \"HLA-DRA\" ... #>   .. .. ..$ : chr [1:80] \"ATGCCAGAACGACT\" \"CATGGCCTGTGCAT\" \"GAACCTGATGAACC\" \"TGACTGGATTCTCA\" ... #>   .. ..@ x       : num [1:4456] 1 1 3 1 1 4 1 5 1 1 ... #>   .. ..@ factors : list() #>  $ tf :'data.frame':\t4485 obs. of  3 variables: #>   ..$ tf    : chr [1:4485] \"ADNP\" \"ADNP\" \"ADNP\" \"AEBP2\" ... #>   ..$ target: chr [1:4485] \"PRF1\" \"TMEM40\" \"TNFRSF1B\" \"CFP\" ... #>   ..$ mor   : num [1:4485] 1 1 1 1 1 1 1 1 1 1 ... #>  $ ppi:'data.frame':\t12754 obs. of  3 variables: #>   ..$ protein1      : chr [1:12754] \"ADNP\" \"ADNP\" \"ADNP\" \"AEBP2\" ... #>   ..$ protein2      : chr [1:12754] \"ZBTB14\" \"NFIA\" \"CDC5L\" \"YY1\" ... #>   ..$ combined_score: num [1:12754] 0.769 0.64 0.581 0.597 0.54 0.753 0.659 0.548 0.59 0.654 ...  # List of 3 # $ gex:Formal class 'dgCMatrix' [package \"Matrix\"] with 6 slots # .. ..@ i       : int [1:4456] 1 5 8 11 22 30 33 34 36 38 ... # .. ..@ p       : int [1:81] 0 47 99 149 205 258 306 342 387 423 ... # .. ..@ Dim     : int [1:2] 230 80 # .. ..@ Dimnames:List of 2 # .. .. ..$ : chr [1:230] \"MS4A1\" \"CD79B\" \"CD79A\" \"HLA-DRA\" ... # .. .. ..$ : chr [1:80] \"ATGCCAGAACGACT\" \"CATGGCCTGTGCAT\" \"GAACCTGATGAACC\" \"TGACTGGATTCTCA\" ... # .. ..@ x       : num [1:4456] 1 1 3 1 1 4 1 5 1 1 ... # .. ..@ factors : list() # $ tf :'data.frame':  4485 obs. of  3 variables: #   ..$ tf    : chr [1:4485] \"ADNP\" \"ADNP\" \"ADNP\" \"AEBP2\" ... # ..$ target: chr [1:4485] \"PRF1\" \"TMEM40\" \"TNFRSF1B\" \"CFP\" ... # ..$ mor   : num [1:4485] 1 1 1 1 1 1 1 1 1 1 ... # $ ppi:'data.frame':  12754 obs. of  3 variables: #   ..$ X.node1       : chr [1:12754] \"ADNP\" \"ADNP\" \"ADNP\" \"AEBP2\" ... # ..$ node2         : chr [1:12754] \"ZBTB14\" \"NFIA\" \"CDC5L\" \"YY1\" ... # ..$ combined_score: num [1:12754] 0.769 0.64 0.581 0.597 0.54 0.753 0.659 0.548 0.59 0.654 ..."}]
